<html>

<head>
<meta name=Generator content="Microsoft Office HTML Filter 2.0">
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Originator content="Microsoft Word 9">
<title> </title>
<style>
<!--
 
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin:0in;
	margin-bottom:.0001pt;
	background:navy;
	font-size:12.0pt;
	font-family:Tahoma;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
span.EmailStyle15
	{
	color:windowtext;}
span.EmailStyle16
	{
	color:windowtext;}
p.HeaderSep, li.HeaderSep, div.HeaderSep
	{
	margin:0in;
	margin-bottom:.0001pt;
	background:#88942C;
	font-size:10.0pt;
	font-family:"Courier New";}
p.Divider, li.Divider, div.Divider
	{
	margin:0in;
	margin-bottom:.0001pt;
	background:teal;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CmdTxt, li.CmdTxt, div.CmdTxt
	{
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:maroon;}
p.ArgTxt, li.ArgTxt, div.ArgTxt
	{
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";
	color:#339966;
	font-weight:bold;}
p.DispTxt, li.DispTxt, div.DispTxt
	{
	margin-top:0in;
	margin-right:.1in;
	margin-bottom:6.0pt;
	margin-left:.1in;
	text-align:justify;
	font-size:10.0pt;
	font-family:Arial;}
p.EmphTxt, li.EmphTxt, div.EmphTxt
	{
	margin-top:0in;
	margin-right:.1in;
	margin-bottom:6.0pt;
	margin-left:.1in;
	text-align:justify;
	font-size:10.0pt;
	font-family:Arial;
	font-weight:bold;}
p.safe, li.safe, div.safe
	{
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.1in;
	margin-bottom:.0001pt;
	background:lime;
	font-size:10.0pt;
	font-family:"Courier New";
	color:#216146;}
p.SyntaxStmt, li.SyntaxStmt, div.SyntaxStmt
	{
	margin-top:12.0pt;
	margin-right:.6in;
	margin-bottom:12.0pt;
	margin-left:.6in;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:maroon;}
p.ArgSyntax, li.ArgSyntax, div.ArgSyntax
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:1.95in;
	margin-bottom:.0001pt;
	text-indent:-1.35in;
	font-size:10.0pt;
	font-family:"Courier New";
	color:#339966;
	font-weight:bold;}
p.DescTxt, li.DescTxt, div.DescTxt
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:1.95in;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-1.35in;
	font-size:10.0pt;
	font-family:"Courier New";
	color:#3366FF;
	font-weight:bold;}
p.AssignTxt, li.AssignTxt, div.AssignTxt
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:2.6in;
	margin-bottom:.0001pt;
	text-indent:-2.0in;
	font-size:10.0pt;
	font-family:"Courier New";
	color:purple;
	font-weight:bold;}
p.CmdDesc, li.CmdDesc, div.CmdDesc
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:1.95in;
	margin-bottom:.0001pt;
	text-indent:-1.35in;
	font-size:10.0pt;
	font-family:"Courier New";
	color:maroon;}
p.AssignDesc, li.AssignDesc, div.AssignDesc
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:2.6in;
	margin-bottom:.0001pt;
	text-indent:-2.0in;
	font-size:10.0pt;
	font-family:"Courier New";
	color:teal;
	font-weight:bold;}
p.ArgType, li.ArgType, div.ArgType
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:2.6in;
	margin-bottom:.0001pt;
	text-indent:-2.0in;
	font-size:10.0pt;
	font-family:"Courier New";
	color:#CC99FF;
	font-style:italic;}
p.DescBullet, li.DescBullet, div.DescBullet
	{
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-indent:-.3in;
	font-size:10.0pt;
	font-family:"Courier New";
	color:green;
	font-weight:bold;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body lang=EN-US>

<div class=Section1>

<p class=MsoNormal>&nbsp;</p>

<p class=HeaderSep>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=DispTxt>The plugin <b>vsutil.vim</b>
contains utility functions used by several of my plugins.  I do think, however, they are much more
generic than the use they were designed for and put to in these plugins.  I therefore have put together this
documentation for the potential user.</p>

<p class=DispTxt>At present, there are 10 public functions and one script local
function, which is accessed by a command. 
There are also 2 other commands related to this one.  I will address them here in no particular
order other than the order in which they appear in the plugin, which is
completely irrelevant.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=MsoPlainText>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";color:maroon'>IsVimNmr </span>returns
Boolean 0 or 1 based on whether or not its argument variable’s content is
wholly numeric.  Typically it is called
in an if statement:</p>

<p class=CmdDesc>if IsVimNmr(<b><i><span style='color:#CC99FF'>{numVar}</span></i></b>)</p>

<p class=AssignDesc>    Do something
with number</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";color:maroon'>IsVimIdent</span>
returns Boolean 0 or 1 based on whether or not its argument variable’s content
conforms to Vim identifier convention.</p>

<p class=CmdDesc>if IsVimIdent(<b><i><span style='color:#CC99FF'>{identVar}</span></i></b>)</p>

<p class=AssignDesc>    Use the
identifier</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";color:maroon'>IsVimVar</span>
returns Boolean –1 or 0 or 1 based on whether or not its argument variable is
an identifier and if so, does it exist. 
The Boolean is –1 == valid, non-existent, 1 == valid, exist, and 0 ==
invalid.</p>

<p class=CmdDesc>let <span style='color:#339966'>g:foo</span>=<span
style='color:purple'>1</span></p>

<p class=CmdDesc>function Foo(<span style='
color:#339966'>var</span>)</p>

<p class=CmdDesc>    echo IsVimVar(<span
style='color:#339966'>a:var</span>)</p>

<p class=CmdDesc>endfunction</p>

<p class=CmdDesc>call Foo(‘g:foo’)</p>

<p class=CmdDesc>call Foo(‘foo’)</p>

<p class=CmdDesc>call Foo(‘0defects’)</p>

<p class=CmdDesc>&nbsp;</p>

<p class=AssignTxt><span style='font-size:14.0pt;
font-family:"Cordia New";font-weight:normal;'>1</span></p>

<p class=AssignTxt><span style='font-size:14.0pt;
font-family:"Cordia New";font-weight:normal;'>-1</span></p>

<p class=AssignTxt><span style='font-size:14.0pt;
font-family:"Cordia New";font-weight:normal;'>0</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";color:maroon'>IsStrLit</span>
returns Boolean 0 or 1 based on whether or not its argument is enclosed in
matching quotes.  This is handy for
removing quotes where they’re not wanted, adding them when they’re wanted, or
telling whether or not you need to dereference.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";color:maroon'>IsArryDecl</span>,
which probably doesn’t belong here, but here it is for now at least, returns
–1, 0, or 1.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";color:maroon'>RGBtoHex</span>
returns the hex of a 0-255 RGB value. 
This was written as part of a response to a posting and I’ve just kept
it around for general purposes.</p>

<p class=DispTxt>&nbsp;</p>

<span style='font-size:10.0pt;font-family:Arial;'><br
clear=all style='page-break-before:always'>
</span>

<p class=DispTxt>Next comes a fairly useful pair of utilities that are based on
a variation of strtok.  They are <span
style='font-family:"Arial Black";color:maroon'>IsStrListTok</span> and <span
style='font-family:"Arial Black";color:maroon'>StrListTok</span>.  The former returns Boolean based on whether
or not its argument is a token separated list defined by the current token
delimiter.  The latter parses a token
separated list defined by the current token delimiter and returns the next
token.  Decision on the delimiter is as
follows:</p>

<p class=DescBullet><span style='font-family:Symbol;
font-weight:normal'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Optional argument to the function</p>

<p class=DescBullet><span style='font-family:Symbol;
font-weight:normal'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Existence of a buffer variable (b:strListTokDelim)</p>

<p class=DescBullet><span style='font-family:Symbol;
font-weight:normal'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Existence of a script variable (s:strListTokDelim)</p>

<p class=DescBullet><span style='font-family:Symbol;
font-weight:normal'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Existence of a global variable (g:strListTokDelim)</p>

<p class=DescBullet><span style='font-family:Symbol;
font-weight:normal'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Default of comma or newline</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>if IsStrListTok(<b><span
style='color:#339966'>myList</span></b>)</p>

<p class=CmdDesc>    let <b><span style='
color:#339966'>myTok</span></b>=StrListTok(<b><span
style='color:#339966'>myList</span></b>,<b><span style='
color:#339966'>’b:myList’</span></b>)</p>

<p class=CmdDesc>    while <b><span style='
color:#339966'>myTok</span></b> != <b><span
style='color:teal'>‘’</span></b></p>

<p class=DescTxt align=left style='margin-left:0in;text-align:left;text-indent:
0in'>               Use token</p>

<p class=CmdDesc>        let <b><span style='
color:#339966'>myTok</span></b>=StrListTok(<b><span
style='color:#339966'>‘’</span></b>,<b><span style='
color:#339966'>’b:myList’</span></b>)</p>

<p class=CmdDesc>    endwhile</p>

<p class=CmdDesc>    unlet <b><span style='
color:#339966'>b:myList</span></b></p>

<p class=CmdDesc>endif</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>The above would parse a comma/newline separated list of
tokens, while the following would do the same with a colon separated list.</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>if IsStrListTok(<b><span
style='color:#339966'>myList,’:’</span></b>)</p>

<p class=CmdDesc>    let <b><span style='
color:#339966'>myTok</span></b>=StrListTok(<b><span
style='color:#339966'>myList</span></b>,<b><span style='
color:#339966'>’b:myList’,’:’</span></b>)</p>

<p class=CmdDesc>    while <b><span style='
color:#339966'>myTok</span></b> != <b><span
style='color:teal'>‘’</span></b></p>

<p class=DescTxt align=left style='margin-left:0in;text-align:left;text-indent:
0in'>               Use token</p>

<p class=CmdDesc>        let <b><span style='
color:#339966'>myTok</span></b>=StrListTok(<b><span
style='color:#339966'>‘’</span></b>,<b><span style='
color:#339966'>’b:myList’</span></b>)</p>

<p class=CmdDesc>    endwhile</p>

<p class=CmdDesc>    unlet <b><span style='
color:#339966'>b:myList</span></b></p>

<p class=CmdDesc>endif</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";
color:maroon'>QualifiedPath</span> decides if its argument is a fully qualified
path file name using the contents of the variable <span style='font-family:"Arial Black";color:maroon'>b:QPATH</span> as a
pattern.  The default is <b><span style='font-family:"Courier New";color:#3366FF'>'^\(\~\|\h:\|\\\|/\)'</span></b>.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";
color:maroon'>FileParts</span> is a lot like an MS/DOS C function I used once
upon a time, but I can’t really remember the name of it.  Anyway, it takes its first argument, a
qualified path or file name that can be expanded into one, and breaks it down
into its constituent parts.  It puts
results into any ‘referenced’ variables you pass to it, empty references
indicating no interest in the part.</p>

<p class=CmdDesc>call
FileParts(fname,’myFullName’,’myPathName’,’myName’,’myExt’)</p>

<p class=CmdDesc>&nbsp;</p>

<span style='font-size:10.0pt;font-family:Arial;'><br
clear=all style='page-break-before:always'>
</span>

<p class=DispTxt>The next group consists of 3 commands and one script-local
function.  It is for placing debug
messages in code, which can be turned on and off.  To start with, you need to execute the command <span
style='font-family:"Arial Black";color:maroon'>SUDEBUGMSG</span>
to set up debugging with the name of a parent script.  This is done by executing the command outside of any function in
the script of your choice.  Next, in any
scripts that make up the functionality of the parent script and in the parent
script itself you place debug commands of the form:</p>

<p class=CmdTxt>DEBUGMSG <b><span
style='font-size:12.0pt;font-family:"Courier New";
color:#339966'>msg</span></b><b><span
style='font-family:"Courier New";color:purple'>[</span></b><b><span style='font-size:12.0pt;font-family:"Courier New";color:#339966'>,lvl</span></b><b><span style='
font-family:"Courier New";color:purple'>]</span></b></p>

<p class=CmdDesc><b><span style='color:
purple'>Where </span></b><b><span
style='color:#339966'>msg</span></b><b><span style='color:purple'>       </span></b><b><span style='color:#3366FF'>is a string</span></b></p>

<p class=CmdDesc>      <b><span style='
color:#339966'>lvl</span></b>       <b><span style='color:#3366FF'>is 0 for normal</span></b></p>

<p class=DescTxt align=left style='text-align:left'>                   1 for
warning</p>

<p class=DescTxt align=left style='margin-left:145.95pt;text-align:left;
text-indent:0in'>&gt; 1 for error</p>

<p class=DescTxt align=left style='text-align:left'>                if not specified, 0 for normal</p>

<p class=CmdDesc><b><span style='color:
purple'>echomsg format</span></b>  <b><span style='color:teal'>&lt;parent-script&gt;::&lt;functions(s)&gt;:
&lt;message&gt;</span></b></p>

<p class=CmdDesc><b><span style='color:
purple'>displayed in</span></b>    <b><span style='color:#3366FF'>black for
normal</span></b></p>

<p class=DescTxt align=left style='text-align:left'>                red for warning</p>

<p class=DescTxt align=left style='text-align:left'>                reverse red for error</p>

<p class=CmdDesc>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>Display of the messages is toggled on and off by executing the
command <span style='font-family:"Arial Black";
color:maroon'>TGLDEBUGMSG</span>.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";
color:maroon'>Pause()</span> is a function that allows echo-ing of
messages/information and pausing to assure that they are seen.</p>

<p class=CmdTxt>Pause(<b><span
style='font-size:12.0pt;font-family:"Courier New";
color:#339966'>msg</span></b>)</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>The <b><span
style='font-family:"Courier New";color:#339966'>msg</span></b> is displayed and the prompt ‘<b><span style='
font-family:"Courier New";color:#339966'>Press
a key to continue</span></b>’, giving the user an opportunity to view the
information.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>Sorting functions/commands from example by Robert Webb
added.  See :h eval-examples ‘Sorting
lines (by Robert Webb)’ for details.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><span style='font-family:"Arial Black";color:maroon'>Uniq()</span>
is a function that compares adjacent lines in a file and if they are equal, deletes
one. </p>

<p class=CmdTxt>Uniq(<span style='color:#339966'>strtline</span>,<span
style='color:#339966'>endline</span>)</p>

<p class=DispTxt>&nbsp;</p>

<p class=HeaderSep>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

</div>

</body>

</html>
